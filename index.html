<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generatore di Idee Casuali</title>
    <meta name="description" content="Genera idee creative casuali per progetti, attivit√†, ricette, viaggi e fitness. Combina categorie per ispirazione unica!">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .card-shadow {
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .slide-in {
            animation: slideIn 0.5s ease-out;
        }

        @media (max-width: 640px) {
            .text-responsive {
                font-size: 1.1rem;
                line-height: 1.6;
            }
        }
    </style>
</head>
<body class="min-h-screen" style="background: linear-gradient(135deg, #1e3a8a 0%, #7c3aed 50%, #ec4899 100%);">
    <canvas id="downloadCanvas" style="display: none;"></canvas>
    
    <div id="app" class="min-h-screen">
        <!-- Header -->
        <header class="flex justify-between items-center p-4 pt-8">
            <h1 class="text-2xl md:text-3xl font-bold text-white flex items-center gap-2">
                üí° Idee Casuali
            </h1>
            <button id="settingsBtn" class="p-2 rounded-full bg-white/20 text-white hover:bg-white/30 transition-all">
                <i data-lucide="settings" class="w-6 h-6"></i>
            </button>
        </header>

        <!-- Settings Panel -->
        <div id="settingsPanel" class="hidden mx-4 mb-4 p-4 rounded-2xl bg-white/10 backdrop-blur-sm text-white slide-in">
            <h3 class="font-bold mb-3 text-lg">‚öôÔ∏è Impostazioni</h3>
            
            <!-- Categories -->
            <div class="mb-4">
                <label class="block text-sm mb-2 font-medium">üéØ Categorie:</label>
                <div id="categoryCheckboxes" class="grid grid-cols-2 gap-2">
                    <!-- Dinamically populated -->
                </div>
            </div>

            <!-- Weirdness Level -->
            <div class="mb-4">
                <label class="block text-sm mb-2 font-medium">
                    üé™ Livello Stranezza: <span id="weirdnessLabel">Normale</span>
                </label>
                <input id="weirdnessSlider" type="range" min="1" max="3" value="1" 
                       class="w-full h-2 bg-white/20 rounded-lg appearance-none cursor-pointer">
            </div>

            <!-- Stats -->
            <div class="text-xs text-white/70 border-t border-white/20 pt-3">
                <p>üìä Database: <span id="totalIdeas">0</span> idee totali</p>
                <p>üîÑ Versione: 1.0</p>
            </div>
        </div>

        <!-- Main Idea Card -->
        <main class="px-4 mb-6">
            <div id="ideaCard" class="relative p-6 md:p-8 rounded-3xl card-shadow transform transition-all duration-500 bg-gradient-to-br from-indigo-500 to-purple-600">
                <div id="categoryBadge" class="absolute top-4 right-4 px-3 py-1 rounded-full bg-black/20 text-white text-sm font-medium hidden">
                </div>
                
                <div class="text-center">
                    <div id="loadingState" class="flex flex-col items-center gap-4">
                        <div class="animate-spin w-8 h-8 border-4 border-white/30 border-t-white rounded-full"></div>
                        <p class="text-white/80">Combinando idee creative...</p>
                    </div>
                    
                    <div id="ideaContent" class="hidden">
                        <p id="ideaText" class="text-white text-responsive md:text-xl font-medium leading-relaxed mb-4">
                        </p>
                        
                        <div class="flex justify-center gap-3 mt-6">
                            <button id="favoriteBtn" class="p-3 rounded-full transition-all bg-white/20 text-white hover:bg-white/30">
                                <i data-lucide="heart" class="w-5 h-5"></i>
                            </button>
                            
                            <button id="downloadBtn" class="p-3 rounded-full bg-white/20 text-white hover:bg-white/30 transition-all">
                                <i data-lucide="download" class="w-5 h-5"></i>
                            </button>
                            
                            <button id="shareBtn" class="p-3 rounded-full bg-white/20 text-white hover:bg-white/30 transition-all">
                                <i data-lucide="share-2" class="w-5 h-5"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Generate Button -->
        <section class="px-4 mb-6">
            <button id="generateBtn" class="w-full py-4 bg-white text-gray-800 rounded-2xl font-bold text-lg shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200 flex items-center justify-center gap-3">
                <i data-lucide="shuffle" class="w-6 h-6"></i>
                Genera Nuova Idea
            </button>
        </section>

        <!-- Stats -->
        <section class="px-4 mb-4">
            <div class="grid grid-cols-2 gap-4">
                <div class="bg-white/10 backdrop-blur-sm rounded-xl p-4 text-center">
                    <div id="favoritesCount" class="text-2xl font-bold text-white">0</div>
                    <div class="text-white/70 text-sm">‚ù§Ô∏è Preferiti</div>
                </div>
                <div class="bg-white/10 backdrop-blur-sm rounded-xl p-4 text-center">
                    <div id="historyCount" class="text-2xl font-bold text-white">0</div>
                    <div class="text-white/70 text-sm">üìù Idee Generate</div>
                </div>
            </div>
        </section>

        <!-- Quick Actions -->
        <section class="px-4 pb-8">
            <div id="quickActions" class="grid grid-cols-3 gap-3">
                <!-- Dinamically populated -->
            </div>
        </section>
    </div>

    <script>
        // Database delle Idee - Integrato direttamente
        const categories = {
            creativo: {
                name: 'Creativo',
                gradient: 'from-red-400 to-pink-500',
                color: '#FF6B6B',
                ideas: [
                    'Dipingi con i colori che rappresentano il tuo umore oggi',
                    'Scrivi una storia di 100 parole su un oggetto casuale',
                    'Crea un collage usando materiali naturali',
                    'Fotografa 15 texture diverse nella tua casa',
                    'Disegna il tuo cibo preferito nello stile di Van Gogh',
                    'Inventa una canzone rap su cosa hai fatto ieri',
                    'Crea sculture con oggetti dalla scrivania',
                    'Scrivi una poesia che inizia con "Se fossi un colore..."',
                    'Ridisegna un logo famoso in stile medievale',
                    'Crea un fumetto di 6 vignette sulla tua mattina',
                    'Costruisci architetture fantastiche con i Lego',
                    'Scatta foto solo di riflessi per 30 minuti',
                    'Inventa un nuovo tipo di pasta e disegnala',
                    'Crea pattern con le tue impronte digitali',
                    'Scrivi un dialogo tra due elettrodomestici',
                    'Dipingi usando solo le dita, mai pennelli',
                    'Crea un autoritratto fatto di emoji',
                    'Inventa una danza per il luned√¨ mattina',
                    'Costruisci un castello con libri e oggetti',
                    'Scrivi la recensione poetica del tuo ultimo sogno',
                    'Crea arte digitale con forme geometriche',
                    'Inventa 10 nomi per colori inesistenti',
                    'Fai un ritratto usando solo parole',
                    'Crea un mandala con oggetti colorati',
                    'Scrivi la biografia di un oggetto inanimato',
                    'Disegna mappe di luoghi immaginari',
                    'Inventa creature fantastiche e il loro habitat',
                    'Crea un museo delle tue memorie d\'infanzia',
                    'Fotografa la stessa scena in 5 stili diversi',
                    'Scrivi lettere dal futuro a te stesso'
                ],
                weirdIdeas: [
                    'Dipingi usando solo condimenti da cucina',
                    'Scrivi una lettera d\'amore a Marte',
                    'Crea arte con oggetti scaduti del frigo',
                    'Fotografa conversazioni tra ombre',
                    'Inventa un linguaggio di rumori domestici',
                    'Dipingi camminando a piedi nudi su tela',
                    'Crea autoritratti solo con cibo colorato',
                    'Componi musica con oggetti di plastica'
                ]
            },
            business: {
                name: 'Business',
                gradient: 'from-teal-400 to-cyan-500',
                color: '#4ECDC4',
                ideas: [
                    'App per scambiare competenze tra vicini',
                    'Servizio di consegna per anziani soli',
                    'Marketplace per affittare spazi per eventi',
                    'Platform per micro-investimenti artistici',
                    'App per sessioni di studio condivise',
                    'Personal shopper per prodotti sostenibili',
                    'Subscription box di hobby vintage',
                    'App per car pooling a concerti',
                    'Dog-walking con livestream',
                    'Platform gamificata per scambio libri',
                    'App per compagni di viaggio last-minute',
                    'Meal prep basato su esami medici',
                    'Marketplace per vendere tempo e competenze',
                    'App per raccolta differenziata gamificata',
                    'Coaching per procrastinatori cronici',
                    'Rental attrezzature tra creativi',
                    'App per condividere orti urbani',
                    'Servizio foto-famiglia in podcast',
                    'Marketplace per scambiare esperienze',
                    'Gruppi di acquisto artigianale',
                    'Pulizie ecologiche auto-prodotte',
                    'Cene multiculturali tra sconosciuti',
                    'App che analizza umore e suggerisce attivit√†',
                    'Tutoraggio peer-to-peer digitale',
                    'Rental abbigliamento per eventi speciali',
                    'App per condividere parcheggi privati',
                    'Consegna express prodotti dimenticati',
                    'Eventi pop-up spontanei nei quartieri',
                    'Networking basato su hobby comuni',
                    'Subscription piante con care personalizzata'
                ],
                weirdIdeas: [
                    'Rental animali virtuali in AR',
                    'Interpretazione professionale dei sogni',
                    'Marketplace per ricordi d\'infanzia',
                    'Speed dating tra piante',
                    'Delivery di emozioni su misura',
                    'Rental temporaneo di personalit√†',
                    'Scambio di superstizioni personali'
                ]
            },
            attivita: {
                name: 'Attivit√†',
                gradient: 'from-blue-400 to-indigo-500',
                color: '#45B7D1',
                ideas: [
                    'Caccia al tesoro fotografica nel quartiere',
                    'Impara un piatto della nonna',
                    'Crea un giardino di erbe sul davanzale',
                    'Karaoke virtuale con amici lontani',
                    'Visita un mercato etnico mai esplorato',
                    'Impara 20 parole in linguaggio dei segni',
                    'Costruisci un forte di cuscini',
                    'Camminata fotografica architettonica',
                    'Torneo di giochi da tavolo con premi fatti in casa',
                    'Origami avanzati con YouTube',
                    'Playlist che racconta la tua vita',
                    'Degustazione professionale di t√®/caff√®',
                    'Volontariato per un pomeriggio',
                    'Impara una canzone con strumento nuovo',
                    'Cinema a tema con costumi d\'epoca',
                    'Time-lapse della giornata ogni 30 minuti',
                    'Tour in bici di tutti i parchi cittadini',
                    'Pane integrale da zero',
                    'Picnic notturno per le stelle',
                    'Lettere cartacee a persone care',
                    'Meditazione avanzata quotidiana',
                    'Mini-documentario famiglia 10 minuti',
                    'Disegno dal vero con modelli',
                    'Basi conversazionali lingua nuova',
                    'Maratona documentari tematici',
                    'Storytelling con storie personali',
                    'Ripara qualcosa di rotto da tempo',
                    'Album fotografico tematico del mese',
                    'Sfida culinaria ingredienti casuali',
                    'Impara 10 costellazioni e le loro storie'
                ],
                weirdIdeas: [
                    'Comunica solo con disegni tutto il giorno',
                    'Cammina con scarpe di misure diverse',
                    'Mangia con utensili sbagliati',
                    'Film muti inventando dialoghi',
                    'Vestiti al contrario per una giornata',
                    'Dormi in una tenda in salotto',
                    'Parla solo con domande retoriche'
                ]
            },
            ricette: {
                name: 'Ricette',
                gradient: 'from-orange-400 to-red-500',
                color: '#FFA726',
                ideas: [
                    'Ramen con brodo vegetale 12h e uova miso',
                    'Smoothie bowl tropicale con granola homemade',
                    'Tacos pesce con salsa mango piccante',
                    'Risotto Barolo con gorgonzola e noci',
                    'Buddha bowl con falafel e hummus barbabietola',
                    'Curry thailandese ceci con latte cocco',
                    'Pancakes proteici frutti bosco yogurt greco',
                    'Zuppa asiatica tofu e funghi shiitake',
                    'Quinoa rossa con melograno e feta',
                    'Pesto genovese nel mortaio',
                    'Burger vegetale barbabietola e lenticchie',
                    'Wok verdure con teriyaki homemade',
                    'Focaccia integrale rosmarino e olive',
                    'Cheesecake frutti bosco senza cottura',
                    'Gazpacho con pomodori San Marzano',
                    'Polpette lenticchie rosse in sugo',
                    'Salmone grigliato quinoa tricolore',
                    'Tiramis√π vegano mascarpone anacardi',
                    'Vellutata zucca con zenzero',
                    'Wrap integrale hummus e germogli',
                    'Muffins salati zucchine e feta',
                    'Paella vegetariana carciofi',
                    'Brownies cioccolato fondente 70%',
                    'Farro con verdure grigliate e mozzarella',
                    'Smoothie detox verde spinaci ananas',
                    'Carbonara vegana crema anacardi',
                    'Ceviche branzino lime e coriandolo',
                    'Lasagne melanzane besciamella cavolfiore',
                    'Pancakes salati ceci e verdure',
                    'Ratatouille provenzale tradizionale'
                ],
                weirdIdeas: [
                    'Pizza dessert nutella e marshmallow',
                    'Gelato salato parmigiano e miele',
                    'Sushi dolce mango e cioccolato bianco',
                    'Hamburger di gelato con biscotti',
                    'Pasta colorata con ingredienti naturali',
                    'Cocktail che cambia colore bevendo',
                    'Torta salata che sembra dolce'
                ]
            },
            viaggi: {
                name: 'Viaggi',
                gradient: 'from-purple-400 to-pink-500',
                color: '#AB47BC',
                ideas: [
                    'Weekend casa galleggiante lago alpino',
                    'Tour enogastronomico e-bike colline',
                    'Notte osservatorio astronomico Via Lattea',
                    'Treno storico paesaggi dolomitici',
                    'Fattoria biodinamica con laboratori',
                    'Road trip fotografico strade romane',
                    'Borgo medievale master class ceramica',
                    'Speleologia grotte illuminazione scenografica',
                    'Tour culinario mercati storici',
                    'Digital detox monastero buddista',
                    'Castelli abbandonati rievocazioni medievali',
                    'Glamping riserva safari notturno',
                    'Crociera fluviale borghi nascosti',
                    'Casa albero bosco secolare',
                    'Cantine naturali vini biodinamici',
                    'Viaggio letterario scrittori famosi',
                    'Villaggio pescatori cucina pescato',
                    'Tour notturno citt√† fantasma',
                    'Weekend termale trattamenti ayurvedici',
                    'Barca vela isole mediterranee',
                    'Agricoltura hands-on raccolta trasformazione',
                    'Tour cinematografico set italiani',
                    'Yurta mongola autentica montagne',
                    'Gastronomia tradizione culinaria regionale',
                    'Survival gentile guide wilderness',
                    'Scavi archeologici partecipati',
                    'Faro ristrutturato vista oceanica',
                    'Volontariato progetti conservazione',
                    'Festival musicali location storiche',
                    'Palazzo storico cene rinascimentali'
                ],
                weirdIdeas: [
                    'Solo mezzi trasporto gialli',
                    'Luoghi con nome 7 lettere esatte',
                    'Parla solo in rima tutto il viaggio',
                    'Cibi con tua iniziale nome',
                    'Dormi ogni notte in alloggio diverso',
                    'Segui solo indicazioni di sconosciuti',
                    'Visita solo posti sognati la notte prima'
                ]
            },
            fitness: {
                name: 'Fitness',
                gradient: 'from-green-400 to-teal-500',
                color: '#66BB6A',
                ideas: [
                    '100 flessioni distribuite nella giornata 30gg',
                    'Funzionale solo peso corporeo',
                    'Yoga flow mattutino 30min',
                    'Circuit training cardio/resistenza',
                    'Camminata veloce + calisthenics parchi',
                    'Stretching profondo con audiolibri',
                    'HIIT 20min musica alta energia',
                    'Pilates core stability posturale',
                    'Danza fitness coreografie online 1h',
                    'Corsa + sprint 45sec ogni 5min',
                    'Total body elastici resistenza',
                    'Tai chi giardino tramonto',
                    'Aqua fitness piscina resistenza',
                    'Calisthenics muscle-up handstand progressivo',
                    'Pliometrico potenza agilit√†',
                    'Walking meditation natura 50min',
                    'Triathlon casalingo corsa/nuoto/cycling',
                    'Funzionale oggetti domestici pesi',
                    'Equilibrio superfici instabili',
                    'Kickboxing shadowboxing musica',
                    'Intervalli scale pubbliche',
                    'Animal flow movimenti naturali',
                    'Forza bande elastiche TRX',
                    'Dance workout cardio tonificazione',
                    'Pranayama + stretching rigenerante',
                    'Bootcamp militare casalingo',
                    'Crossfit WOD adattato casa',
                    'Metabolico EMOM 20 minuti',
                    'Mobilit√† articolare prevenzione',
                    'Cardio dance latino salsa bachata'
                ],
                weirdIdeas: [
                    'Solo vestiti colore preferito giornata',
                    'Esercizi quando senti sirene/clacson',
                    'Ogni esercizio ridendo a crepapelle',
                    'Solo pavimenti pattern geometrici',
                    'Fitness solo con musica anni 80/90',
                    'Parla in terza persona come commentatore',
                    'Tocca 3 oggetti diversi tra esercizi'
                ]
            }
        };

        // App State
        let currentIdea = '';
        let currentCategory = '';
        let favorites = [];
        let history = [];
        let selectedCategories = ['creativo'];
        let weirdnessLevel = 1;

        // Load from localStorage
        try {
            favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
            history = JSON.parse(localStorage.getItem('history') || '[]');
            selectedCategories = JSON.parse(localStorage.getItem('selectedCategories') || '["creativo"]');
            weirdnessLevel = parseInt(localStorage.getItem('weirdnessLevel') || '1');
        } catch (e) {
            console.log('LocalStorage error:', e);
        }

        // DOM Elements
        const elements = {
            settingsBtn: document.getElementById('settingsBtn'),
            settingsPanel: document.getElementById('settingsPanel'),
            categoryCheckboxes: document.getElementById('categoryCheckboxes'),
            weirdnessSlider: document.getElementById('weirdnessSlider'),
            weirdnessLabel: document.getElementById('weirdnessLabel'),
            ideaCard: document.getElementById('ideaCard'),
            categoryBadge: document.getElementById('categoryBadge'),
            loadingState: document.getElementById('loadingState'),
            ideaContent: document.getElementById('ideaContent'),
            ideaText: document.getElementById('ideaText'),
            favoriteBtn: document.getElementById('favoriteBtn'),
            downloadBtn: document.getElementById('downloadBtn'),
            shareBtn: document.getElementById('shareBtn'),
            generateBtn: document.getElementById('generateBtn'),
            favoritesCount: document.getElementById('favoritesCount'),
            historyCount: document.getElementById('historyCount'),
            quickActions: document.getElementById('quickActions'),
            totalIdeas: document.getElementById('totalIdeas')
        };

        // Utility Functions
        const saveToStorage = (key, data) => {
            try {
                localStorage.setItem(key, JSON.stringify(data));
            } catch (e) {
                console.log('LocalStorage save error:', e);
            }
        };
        
        const getCardGradient = (categoryKey) => {
            if (categoryKey.includes('+')) return 'from-pink-400 via-purple-500 to-indigo-600';
            return categories[categoryKey]?.gradient || 'from-gray-400 to-gray-600';
        };

        const getCategoryDisplayName = (categoryKey) => {
            if (categoryKey.includes('+')) {
                const cats = categoryKey.split('+');
                return cats.map(cat => categories[cat]?.name || cat).join(' + ');
            }
            return categories[categoryKey]?.name || categoryKey;
        };

        const updateStats = () => {
            elements.favoritesCount.textContent = favorites.length;
            elements.historyCount.textContent = history.length;
            
            let totalIdeas = 0;
            Object.values(categories).forEach(cat => {
                totalIdeas += cat.ideas.length + cat.weirdIdeas.length;
            });
            elements.totalIdeas.textContent = totalIdeas;
        };

        // Initialize UI
        const initializeUI = () => {
            // Create category checkboxes
            Object.entries(categories).forEach(([key, category]) => {
                const label = document.createElement('label');
                label.className = 'flex items-center gap-2 text-sm cursor-pointer hover:bg-white/10 p-2 rounded';
                label.innerHTML = `
                    <input type="checkbox" ${selectedCategories.includes(key) ? 'checked' : ''} 
                           data-category="${key}" class="rounded">
                    ${category.name}
                `;
                elements.categoryCheckboxes.appendChild(label);
            });

            // Create quick action buttons
            Object.entries(categories).slice(0, 3).forEach(([key, category]) => {
                const button = document.createElement('button');
                button.className = `p-3 rounded-xl bg-gradient-to-r ${category.gradient} text-white text-sm font-medium shadow-lg hover:shadow-xl transform hover:scale-105 transition-all`;
                button.textContent = category.name;
                button.addEventListener('click', () => {
                    selectedCategories = [key];
                    saveToStorage('selectedCategories', selectedCategories);
                    updateCategoryCheckboxes();
                    generateIdea();
                });
                elements.quickActions.appendChild(button);
            });

            // Set initial values
            elements.weirdnessSlider.value = weirdnessLevel;
            updateWeirdnessLabel();
            updateStats();
        };

        const updateCategoryCheckboxes = () => {
            const checkboxes = elements.categoryCheckboxes.querySelectorAll('input[type="checkbox"]');
            checkboxes.forEach(checkbox => {
                checkbox.checked = selectedCategories.includes(checkbox.dataset.category);
            });
        };

        const updateWeirdnessLabel = () => {
            const labels = ['Normale', 'Strano', 'Bizzarro'];
            elements.weirdnessLabel.textContent = labels[weirdnessLevel - 1] || 'Normale';
        };

        // Core Functions
        const generateIdea = () => {
            console.log('Generating idea...'); // Debug
            elements.loadingState.style.display = 'flex';
            elements.ideaContent.style.display = 'none';
            
            setTimeout(() => {
                const selectedCats = selectedCategories.length > 0 ? selectedCategories : ['creativo'];
                let finalIdea = '';
                let primaryCategory = '';
                
                console.log('Selected categories:', selectedCats); // Debug
                
                if (selectedCats.length === 1) {
                    const category = categories[selectedCats[0]];
                    let ideaPool = [...category.ideas];
                    if (weirdnessLevel >= 3) ideaPool = [...category.ideas, ...category.weirdIdeas];
                    finalIdea = ideaPool[Math.floor(Math.random() * ideaPool.length)];
                    primaryCategory = selectedCats[0];
                } else {
                    const shouldCombine = Math.random() > 0.3;
                    if (shouldCombine && selectedCats.length >= 2) {
                        const shuffled = [...selectedCats].sort(() => 0.5 - Math.random());
                        const cat1Key = shuffled[0];
                        const cat2Key = shuffled[1];
                        const cat1 = categories[cat1Key];
                        const cat2 = categories[cat2Key];
                        let pool1 = [...cat1.ideas];
                        let pool2 = [...cat2.ideas];
                        if (weirdnessLevel >= 3) {
                            pool1 = [...cat1.ideas, ...cat1.weirdIdeas];
                            pool2 = [...cat2.ideas, ...cat2.weirdIdeas];
                        }
                        const idea1 = pool1[Math.floor(Math.random() * pool1.length)];
                        const idea2 = pool2[Math.floor(Math.random() * pool2.length)];
                        const templates = [
                            `Combina ${cat1.name.toLowerCase()} e ${cat2.name.toLowerCase()}: ${idea1.split(':')[0]} + ${idea2.split(':')[0]}`,
                            `Sfida mista: ${idea1} MA in stile ${cat2.name.toLowerCase()}`,
                            `Fusion: ${idea2} incorporando ${idea1.toLowerCase()}`,
                            `Cross-training: ${idea1} + ${idea2.replace(/^[A-Z][a-z]+ /, '').toLowerCase()}`,
                            `Esperimento: ${idea2.split(' ').slice(0, 3).join(' ')} + ${idea1.split(' ').slice(-3).join(' ')}`
                        ];
                        finalIdea = templates[Math.floor(Math.random() * templates.length)];
                        primaryCategory = `${cat1Key}+${cat2Key}`;
                    } else {
                        const randomCat = selectedCats[Math.floor(Math.random() * selectedCats.length)];
                        const
